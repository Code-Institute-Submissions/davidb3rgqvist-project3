import gspread
from google.oauth2.service_account import Credentials

SCOPE = [
    "https://www.googleapis.com/auth/spreadsheets",
    "https://www.googleapis.com/auth/drive.file",
    "https://www.googleapis.com/auth/drive"
    ]

CREDS = Credentials.from_service_account_file('creds.json')
SCOPED_CREDS = CREDS.with_scopes(SCOPE)
GSPREAD_CLIENT = gspread.authorize(SCOPED_CREDS)
SHEET = GSPREAD_CLIENT.open('ProductSurvey')

def welcome_message():
    print()
    print("Apple Vision Pro Buying Survey!")
    print("""
............................................................................................................
............................................................................................................
............................................................................................................
............................................................................................................
............................................................................................................
............................................................................................................
............................................................................................................
.............................................:----===----:..................................................
....................................:-=====----------------==++=:...........................................
.................................-+=---:---:--------------------=++:........................................
...............................==----------:------------:---------=*:.......................................
.........................:=++*********++++==---------:--:---------=**.......................................
..................::::-=++++********************+=---:--:---------+*+:......................................
..............:=-=++++**++====----------==++*********---::--------**+-......................................
.............------------:::::::::::::::::::::--=+*****=::------+**++-......................................
............=:----::::::..:::::::::::::::::::::::::-+***+--:--=+***++-......................................
...........-=::..........:::::::::..........:::::-:::-+*++-+*****+++++:.....................................
...........-=--:::::::...:::::::::...........::::::-::-+**********+++.==...::::::...........................
...........------:::::::::::::::::............:::::::.:-*********+++-..:=++++++++++++=-:....................
...........------:::::::::::::::::.::.........::::::::::+********-.....-++=--:::::--===+=...................
...........-=----::::::::::::::::::::::.......::::::::::=*******-......-===+++++++++++++==-.................
...........:=----:::::::::::::::::::::::::::::::::::::::=++=*=:..........::-==+++++++++++++=--:.............
............=----:::::::::::::::::::::::::::::::::::::::++=..................=++++++++++++++++++-...........
.............=---::::::::::::::::::::::::::::::::::::::=+=.................:++++++++++++++++++++=...........
..............=---::::::::----:::::::::::::::::::::::--+-.................=+++++++++++++++++++++............
...............:---::::---:.....::::::::::::::::::::--:.................:=++++++++++++++++++++=.............
..................:::..............:::::::::::::::::...................-++++++++++++++++++++++:.............
.......................................:::::::::......................=+*****************++++:..............
......................................................................-++++++++++++++++++*++:...............
........................................................................:--===+++++++++++++-................
......................................................................................::::..................
............................................................................................................
..........*####:...=######*=..+#####**:.:*##......=#######*.................................................
.........:##*##-...=##+--*#*-.+##=-=*#*.:*##......=##=-----.................................................
.........=##-##+...=##=..-##+.+##:..+##::*##......=##-......................................................
.........+#*.*#*...=##=..-##+.+##:..+##::*##......=##-......................................................
.........*#+.+#*:..=##=..=##=.+##:..+#*::*##......=##++++-..................................................
........:##-.=*#=..=#######*:.+#######+.:*##......=##****+..................................................
........+##:.-*#*..=##*+=-:...+##++=-...:*##......=##-......................................................
........*##****##:.=##=.......+##:......:*##......=##-......................................................
.......-##*+++*##=.=##=.......+##:......:*##......=##-......................................................
.......=##-...-##+.=##=.......+##:......:*######*:=#######*.................................................
.......=++.....++=.-++-.......=++:......:+++++++=.-+++++++=.................................................
............................::..............::...............................................:::............
.......=##=....*#+.=##-..=*####*-..+##-..-*#####+..:###*..:*#=......+######*:..#######*:...+######-.........
.......-##*...-##=.=##-.=##*::+#*:.+##-.-*#*::+##=.:####=.:*#=......+##=:-*#*-.##*-:=##*:.+##+::*#*:........
.......:###:..+##:.=##-.+##=..=**-.+##-.=##=..-*#*.:####*::*#=......+##=..+##=.##*:..*#*-.*##...=##-........
........*##-..*#*..=##-.-##*:......+##-.=##=..-*#*.:##***=:*#=......+##=..+##=.##*:..*#*-.*##...=##-........
........=##=.:*#=..=##-..=*##+.....+##-.=##=..-*#*.:##+=#*:*#=......+##=..+##=.##*:.=##*..*##...=##-........
........:*#+.-**:..=##-...:+##*=...+##-.=##=..-*#*.:##+:*#=*#=......+##***##*..######*+...*##...=##-........
.........*#*.+#*...=##-.....:*##+..+##-.=##=..-*#*.:##+.=#**#=......+##*+==:...##*-:=##*:.*##...=##-........
.........+##:*#+...=##-.=++:..+##-.+##-.=##=..-*#*.:##+.:*###=......+##=.......##*:..*#*-.*##...=##-........
.........=##+*#=...=##-.+##:..+##=.+##-.=##=..-*#+.:##+..=###=......+##=.......##*:..*#*-.+##...=##-........
.........:#####:...=##-.-*#***##*..+##-.:*##***#*:.:##+..:*##=......+##=.......##*:..*#*-.-###**##*.........
..........+++++....=++-...=***+-...=++-...-+***=...:++=...=++=......+++-.......+++:..=++-...=***+-..........
............................................................................................................
............................................................................................................
............................................................................................................
............................................................................................................
    """)
    print()
    print("This survey aims to gather insights into the likelihood of purchasing the Apple Vision Pro product.")
    print()
    print("1. Insert Data")
    print("2. Extract Analyzed Data")
    print("3. View Stored Data")
    print("4. Exit\n")

def insert_data():
    """
    The user enter data: gender, age-group, income bracket, likelihood of purchasing
    """
    print("Please provide the following information:\n")

    # Choose gender
    gender_choices = {'M': 'Male', 'F': 'Female'}
    gender_input = input("Gender (M/F): ").strip().upper()
    while gender_input not in gender_choices:
        print("Invalid choice. Please choose either 'M' or 'F'.")
        gender_input = input("Gender (M/F): ").strip().upper()
    gender = gender_choices[gender_input]
    print()
    print()

    sheet = GSPREAD_CLIENT.open('ProductSurvey')

    input_data_worksheet = sheet.worksheet('Input data')

    input_data_worksheet.append_row([gender])
    print()
    print("Data has been successfully inserted into the spreadsheet.\n")


def extract_analyzed_data():
    """
    The user extract data based on search: gender, age-group, income bracket.
    recives procentage of likelihood of purchasing the Apple Vision Pro. 
    the result will also get categorized in strong, medium and low chance of purchasing.
    the user has the option to store the search result
    """
    print("Extract Analyzed Data")


def view_stored_data():
    """
    The user can view their latest stored search result
    """
    print("View Stored Data")


def main():
    while True:
        welcome_message()
        choice = input("Enter your choice: ")
        print()

        if choice == '1':
            insert_data()
        elif choice == '2':
            extract_analyzed_data()
        elif choice == '3':
            view_stored_data()
        elif choice == '4':
            print("Exiting the program...\n")
            break
        else:
            print("Invalid choice. Please try again.")

if __name__ == "__main__":
    main()
